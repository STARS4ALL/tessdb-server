Prioridad Alta
==============

* SQL excepcion => Imprimir la fila de los datos

* Añadir columna filter
- Tocar el diagrama con Dia
- añadir a mano ALTER TABLE tess_t ADD COLUMN filter TEXT DEFAULT 'Clear';
- añadir la columna en tess.py
- modificar el metodo register para poner bajo cambio versionado esta columna también
  teniendo en cuenta que en el protocolo de registro este campo puede ser opcional
  - tratar valor por defecto en el mqttservice.py
  - añadir filter en findName()
  - ver si ha cambiado el ZP, el valor del filtro o los 2. Puede servir el mismo UPDATE SQL.
- test unitarios de register

* Informes diarios de instrumentos registrados
  - Instrumentos actuales y su localización. Cabeceras tal y como las pinta Jaime en su informe
  - Añadir cosas al scrpt sql de copiado que di a Jaime.
  - Historico de cambios en los instumentos (solo el ZP y el filtro y las fechas)

* Mejorar la utilidad de tess para gestionar el campo filter (y el zp) asi como el resto
  de dimensiones
    sub-operacion de modify con campos opcionales que indican la columna
    estoimplica hacer SQL a medida para solo actualizar las columnas dadas 
  opcion --latest para fikjar solo el valor actiañ del zp y filter 

* Manual de operaciones de la utilidad tess




Prioridad baja
=============

*) Renombra la columnas frequency y magnitude a frequency1 y magnitude1 en previsiónde una posible
evolución hacia un TESS multicanal. (frequency2,magnitude2, frequency3,magnitude3, etc.)
*) Meter mas metadatos a los instrumentos (ver addednum)
 - Esto implica cambios en el firmware, en el protocolo JSON/MQTT y en la BD
 - hay que hacerlo de forma coordinada.
 - Mantener compatibilidad con rev: 1
 - No snowflakes en la BD, "aplanar campos" canal1, canal2, canal3, canal4 
 - muchos de los metadatos irán en la info de mensaje de registro del TESS.
*) Estudiar si merece la pena poner nuevas constraints UNIQUE NOT NULL a tess_t.name y tess_t.mac_address
*) Embeber servidor web de twisted.

NOTE
====

He averiguado que los descartes son por el 'retained' flag

ADDENDUM
========

Formato estándar de IDA-IAU con info de la siguiente cabecera:

# Device type: TESS-V1
# Data supplier: Alejandro Sanchez de Miguel  / UCM
# Local timezone: UTC+1
# Time Synchronization: NTP
# Moving / Stationary position: STATIONARY
# Moving / Fixed look direction: FIXED
# Number of channels: 1
# Filters per channel: HOYA CM-500
# Measurement direction per channel: 0., 0.
# Field of view: 20

Otro descriptor de las cabeceras que se usan actualmente es # Device type: SQM-LU
# SQM cover offset value: -0.11
pero en nuestro caso la calibración se realizará con la carcasa (a través de la ventana) y no es relevante.

Para TESS-V1 sólo hay un canal pero habrá con suerte de varios canales (colores). Seguramente prepararemos algunos que apunten a diferentes direcciones fijas y no sólo el cénit (45 deg en dirección norte, por ejemplo). Otro asunto importante es el campo de visión FOV.
Propongo emntonces que se tenga en cuenta añadiendo si hace falta algún campo.

